var distance = {
"type": "FeatureCollection",
"crs": { "type": "name", "properties": { "name": "distance" } },
"features": [
  { "type": "Feature", "properties": { "dec_id": "139260", "mission_id": 8, "tag_sn": 895, "mission_end": "2015-09-15 06:00:00", "Platform_ID_No": 139260, "first_posrep": "2015-09-15 07:55:11", "Loc_quality": "B", "Latitude": 48.18396, "Longitude": -88.67762, "pop_Geom": null, "species": "FT", "sex": "F", "maturity": "S", "lipid": 73.3, "length_mm": 883.0, "weight_g": 9655.0, "release_date": "2015-06-03 00:00:00", "release_group": "2", "release_Geom": null, "distance_traveled_km": 8.292150913435858, "mission_duration_days": 104.0, "report_delay_days": 0.079988426063209772 }, "geometry": { "type": "LineString", "coordinates": [ [ -88.67762, 48.18396 ], [ -88.71483333, 48.11366667 ] ] } },
  { "type": "Feature", "properties": { "dec_id": "139263", "mission_id": 8, "tag_sn": 970, "mission_end": "2015-09-13 06:00:00", "Platform_ID_No": 139263, "first_posrep": "2015-09-13 14:36:28", "Loc_quality": "B", "Latitude": 48.01486, "Longitude": -89.06286, "pop_Geom": null, "species": "FT", "sex": "M", "maturity": "S", "lipid": 74.2, "length_mm": 844.0, "weight_g": 10235.0, "release_date": "2015-06-03 00:00:00", "release_group": "1", "release_Geom": null, "distance_traveled_km": 27.632676870953333, "mission_duration_days": 102.0, "report_delay_days": 0.3586574075743556 }, "geometry": { "type": "LineString", "coordinates": [ [ -89.06286, 48.01486 ], [ -88.72866667, 48.1225 ] ] } },
  { "type": "Feature", "properties": { "dec_id": "139265", "mission_id": 8, "tag_sn": 983, "mission_end": "2015-09-14 06:00:00", "Platform_ID_No": 139265, "first_posrep": "2015-09-14 09:48:44", "Loc_quality": "A", "Latitude": 48.15568, "Longitude": -89.09548, "pop_Geom": null, "species": "FT", "sex": "M", "maturity": "S", "lipid": 76.1, "length_mm": 907.0, "weight_g": 9200.0, "release_date": "2015-06-03 00:00:00", "release_group": "1", "release_Geom": null, "distance_traveled_km": 27.548054704798606, "mission_duration_days": 103.0, "report_delay_days": 0.1588425925001502 }, "geometry": { "type": "LineString", "coordinates": [ [ -89.09548, 48.15568 ], [ -88.72866667, 48.1225 ] ] } },
  { "type": "Feature", "properties": { "dec_id": "139266", "mission_id": 8, "tag_sn": 992, "mission_end": "2015-09-15 06:00:00", "Platform_ID_No": 139266, "first_posrep": "2015-09-15 07:56:59", "Loc_quality": "B", "Latitude": 48.03995, "Longitude": -89.24352, "pop_Geom": null, "species": "FT", "sex": "F", "maturity": "S", "lipid": 77.7, "length_mm": 888.0, "weight_g": 12690.0, "release_date": "2015-06-03 00:00:00", "release_group": "2", "release_Geom": null, "distance_traveled_km": 40.238430869102864, "mission_duration_days": 104.0, "report_delay_days": 0.081238425802439451 }, "geometry": { "type": "LineString", "coordinates": [ [ -89.24352, 48.03995 ], [ -88.71483333, 48.11366667 ] ] } },
  { "type": "Feature", "properties": { "dec_id": "139267", "mission_id": 8, "tag_sn": 993, "mission_end": "2015-09-15 06:00:00", "Platform_ID_No": 139267, "first_posrep": "2015-09-15 09:37:54", "Loc_quality": "B", "Latitude": 48.1695, "Longitude": -88.53531, "pop_Geom": null, "species": "LT", "sex": "M", "maturity": "Y", "lipid": 24.6, "length_mm": 718.0, "weight_g": 2320.0, "release_date": "2015-06-04 00:00:00", "release_group": "1", "release_Geom": null, "distance_traveled_km": 10.516318055164305, "mission_duration_days": 103.0, "report_delay_days": 0.1513194446451962 }, "geometry": { "type": "LineString", "coordinates": [ [ -88.53531, 48.1695 ], [ -88.66516667, 48.13216667 ] ] } },
  { "type": "Feature", "properties": { "dec_id": "149934", "mission_id": 8, "tag_sn": 996, "mission_end": "2015-09-15 06:00:00", "Platform_ID_No": 149934, "first_posrep": "2015-09-15 11:13:53", "Loc_quality": "B", "Latitude": 48.15886, "Longitude": -89.04456, "pop_Geom": null, "species": "FT", "sex": "M", "maturity": "S", "lipid": 72.8, "length_mm": 904.0, "weight_g": 10610.0, "release_date": "2015-06-03 00:00:00", "release_group": "1", "release_Geom": null, "distance_traveled_km": 23.854578824154817, "mission_duration_days": 104.0, "report_delay_days": 0.21797453705221415 }, "geometry": { "type": "LineString", "coordinates": [ [ -89.04456, 48.15886 ], [ -88.72866667, 48.1225 ] ] } },
  { "type": "Feature", "properties": { "dec_id": "139274", "mission_id": 8, "tag_sn": 1013, "mission_end": "2015-09-14 06:00:00", "Platform_ID_No": 139274, "first_posrep": "2015-09-14 09:46:12", "Loc_quality": "A", "Latitude": 47.79996, "Longitude": -89.15436, "pop_Geom": null, "species": "LT", "sex": "M", "maturity": "Y", "lipid": 19.8, "length_mm": 749.0, "weight_g": 3530.0, "release_date": "2015-06-05 00:00:00", "release_group": "1", "release_Geom": null, "distance_traveled_km": 69.693222371420887, "mission_duration_days": 101.0, "report_delay_days": 0.15708333346992731 }, "geometry": { "type": "LineString", "coordinates": [ [ -89.15436, 47.79996 ], [ -88.4185, 48.18583333 ] ] } },
  { "type": "Feature", "properties": { "dec_id": "149935", "mission_id": 8, "tag_sn": 1028, "mission_end": "2015-09-13 06:00:00", "Platform_ID_No": 149935, "first_posrep": "2015-09-13 19:49:16", "Loc_quality": "2", "Latitude": 48.19108, "Longitude": -88.3705, "pop_Geom": null, "species": "RF", "sex": "F", "maturity": "Y", "lipid": 27.6, "length_mm": 755.0, "weight_g": 4155.0, "release_date": "2015-06-02 00:00:00", "release_group": "1", "release_Geom": null, "distance_traveled_km": 3.676003391468611, "mission_duration_days": 103.0, "report_delay_days": 0.57587962970137596 }, "geometry": { "type": "LineString", "coordinates": [ [ -88.3705, 48.19108 ], [ -88.419, 48.18466667 ] ] } },
  { "type": "Feature", "properties": { "dec_id": "149937", "mission_id": 8, "tag_sn": 1072, "mission_end": "2015-09-13 06:00:00", "Platform_ID_No": 149937, "first_posrep": "2015-09-13 09:46:50", "Loc_quality": "B", "Latitude": 48.17917, "Longitude": -88.52109, "pop_Geom": null, "species": "LT", "sex": "M", "maturity": null, "lipid": 25.2, "length_mm": 914.0, "weight_g": 6750.0, "release_date": "2015-06-02 00:00:00", "release_group": "1", "release_Geom": null, "distance_traveled_km": 7.6162425260506037, "mission_duration_days": 103.0, "report_delay_days": 0.15752314822748303 }, "geometry": { "type": "LineString", "coordinates": [ [ -88.52109, 48.17917 ], [ -88.419, 48.18466667 ] ] } },
  { "type": "Feature", "properties": { "dec_id": "149939", "mission_id": 8, "tag_sn": 1082, "mission_end": "2015-09-13 06:00:00", "Platform_ID_No": 149939, "first_posrep": "2015-09-13 11:18:14", "Loc_quality": "B", "Latitude": 48.19805, "Longitude": -88.38013, "pop_Geom": null, "species": "LT", "sex": "F", "maturity": "Y", "lipid": 57.3, "length_mm": 910.0, "weight_g": 7770.0, "release_date": "2015-06-05 00:00:00", "release_group": "1", "release_Geom": null, "distance_traveled_km": 3.1596546742925469, "mission_duration_days": 100.0, "report_delay_days": 0.22099537029862404 }, "geometry": { "type": "LineString", "coordinates": [ [ -88.38013, 48.19805 ], [ -88.4185, 48.18583333 ] ] } },
  { "type": "Feature", "properties": { "dec_id": "149940", "mission_id": 8, "tag_sn": 1097, "mission_end": "2015-09-14 06:00:00", "Platform_ID_No": 149940, "first_posrep": "2016-06-19 19:00:55", "Loc_quality": "B", "Latitude": 48.1785, "Longitude": -88.76092, "pop_Geom": null, "species": "LT", "sex": "M", "maturity": null, "lipid": 46.1, "length_mm": 769.0, "weight_g": 4495.0, "release_date": "2015-06-03 00:00:00", "release_group": "1", "release_Geom": null, "distance_traveled_km": 6.6732948800617793, "mission_duration_days": 382.0, "report_delay_days": 279.54230324085802 }, "geometry": { "type": "LineString", "coordinates": [ [ -88.76092, 48.1785 ], [ -88.72866667, 48.1225 ] ] } },
  { "type": "Feature", "properties": { "dec_id": "149941", "mission_id": 8, "tag_sn": 1109, "mission_end": "2015-09-14 06:00:00", "Platform_ID_No": 149941, "first_posrep": "2015-09-14 09:46:21", "Loc_quality": "A", "Latitude": 48.11736, "Longitude": -88.50121, "pop_Geom": null, "species": "LT", "sex": "M", "maturity": null, "lipid": 38.3, "length_mm": 814.0, "weight_g": 4855.0, "release_date": "2015-06-02 00:00:00", "release_group": "1", "release_Geom": null, "distance_traveled_km": 9.665864673450324, "mission_duration_days": 104.0, "report_delay_days": 0.1571875000372529 }, "geometry": { "type": "LineString", "coordinates": [ [ -88.50121, 48.11736 ], [ -88.419, 48.18466667 ] ] } },
  { "type": "Feature", "properties": { "dec_id": "150146", "mission_id": 8, "tag_sn": 1113, "mission_end": "2015-09-14 06:00:00", "Platform_ID_No": 150146, "first_posrep": "2015-09-14 19:34:15", "Loc_quality": "0", "Latitude": 48.19757, "Longitude": -88.40424, "pop_Geom": null, "species": "RF", "sex": "F", "maturity": "Y", "lipid": 32.0, "length_mm": 850.0, "weight_g": 5820.0, "release_date": "2015-06-02 00:00:00", "release_group": "1", "release_Geom": null, "distance_traveled_km": 1.8063366732446797, "mission_duration_days": 104.0, "report_delay_days": 0.5654513887129724 }, "geometry": { "type": "LineString", "coordinates": [ [ -88.40424, 48.19757 ], [ -88.419, 48.18466667 ] ] } },
  { "type": "Feature", "properties": { "dec_id": "149942", "mission_id": 8, "tag_sn": 1424, "mission_end": "2015-09-14 06:00:00", "Platform_ID_No": 149942, "first_posrep": "2015-09-14 15:31:43", "Loc_quality": "3", "Latitude": 48.13993, "Longitude": -88.67469, "pop_Geom": null, "species": "RF", "sex": "F", "maturity": "Y", "lipid": 17.2, "length_mm": 864.0, "weight_g": 5335.0, "release_date": "2015-06-04 00:00:00", "release_group": "1", "release_Geom": null, "distance_traveled_km": 1.1169492183813747, "mission_duration_days": 102.0, "report_delay_days": 0.39702546317130327 }, "geometry": { "type": "LineString", "coordinates": [ [ -88.67469, 48.13993 ], [ -88.66516667, 48.13216667 ] ] } },
  { "type": "Feature", "properties": { "dec_id": "149944", "mission_id": 8, "tag_sn": 1441, "mission_end": "2015-09-15 06:00:00", "Platform_ID_No": 149944, "first_posrep": "2015-09-15 07:52:49", "Loc_quality": "B", "Latitude": 47.97099, "Longitude": -88.75989, "pop_Geom": null, "species": "LT", "sex": "M", "maturity": "Y", "lipid": 55.0, "length_mm": 738.0, "weight_g": 4345.0, "release_date": "2015-06-04 00:00:00", "release_group": "1", "release_Geom": null, "distance_traveled_km": 19.262552147594494, "mission_duration_days": 103.0, "report_delay_days": 0.078344907611608505 }, "geometry": { "type": "LineString", "coordinates": [ [ -88.75989, 47.97099 ], [ -88.66516667, 48.13216667 ] ] } },
  { "type": "Feature", "properties": { "dec_id": "150148", "mission_id": 8, "tag_sn": 1443, "mission_end": "2015-09-13 06:00:00", "Platform_ID_No": 150148, "first_posrep": "2015-09-14 01:39:09", "Loc_quality": "B", "Latitude": 48.16363, "Longitude": -88.432, "pop_Geom": null, "species": "LT", "sex": "F", "maturity": null, "lipid": 47.1, "length_mm": 754.0, "weight_g": 4255.0, "release_date": "2015-06-02 00:00:00", "release_group": "1", "release_Geom": null, "distance_traveled_km": 2.5310905639658094, "mission_duration_days": 104.0, "report_delay_days": 0.81885416666045785 }, "geometry": { "type": "LineString", "coordinates": [ [ -88.432, 48.16363 ], [ -88.419, 48.18466667 ] ] } },
  { "type": "Feature", "properties": { "dec_id": "149946", "mission_id": 8, "tag_sn": 1455, "mission_end": "2015-09-14 06:00:00", "Platform_ID_No": 149946, "first_posrep": "2015-09-14 17:53:28", "Loc_quality": "B", "Latitude": 47.65524, "Longitude": -88.23599, "pop_Geom": null, "species": "FT", "sex": "M", "maturity": "S", "lipid": 78.4, "length_mm": 817.0, "weight_g": 8390.0, "release_date": "2015-06-03 00:00:00", "release_group": "2", "release_Geom": null, "distance_traveled_km": 62.295085843622985, "mission_duration_days": 103.0, "report_delay_days": 0.4954629628919065 }, "geometry": { "type": "LineString", "coordinates": [ [ -88.23599, 47.65524 ], [ -88.71483333, 48.11366667 ] ] } },
  { "type": "Feature", "properties": { "dec_id": "149947", "mission_id": 8, "tag_sn": 1461, "mission_end": "2015-09-15 06:00:00", "Platform_ID_No": 149947, "first_posrep": "2015-09-15 09:36:16", "Loc_quality": "B", "Latitude": 48.05474, "Longitude": -86.55825, "pop_Geom": null, "species": "FT", "sex": "M", "maturity": "S", "lipid": 76.7, "length_mm": 884.0, "weight_g": 12175.0, "release_date": "2015-06-03 00:00:00", "release_group": "2", "release_Geom": null, "distance_traveled_km": 160.80199165137688, "mission_duration_days": 104.0, "report_delay_days": 0.15018518501892686 }, "geometry": { "type": "LineString", "coordinates": [ [ -86.55825, 48.05474 ], [ -88.71483333, 48.11366667 ] ] } },
  { "type": "Feature", "properties": { "dec_id": "149949", "mission_id": 8, "tag_sn": 1502, "mission_end": "2015-09-15 06:00:00", "Platform_ID_No": 149949, "first_posrep": "2015-09-15 09:35:42", "Loc_quality": "A", "Latitude": 47.64402, "Longitude": -87.99138, "pop_Geom": null, "species": "FT", "sex": "M", "maturity": "S", "lipid": 75.7, "length_mm": 918.0, "weight_g": 11710.0, "release_date": "2015-06-03 00:00:00", "release_group": "1", "release_Geom": null, "distance_traveled_km": 76.62350242899484, "mission_duration_days": 104.0, "report_delay_days": 0.14979166677221656 }, "geometry": { "type": "LineString", "coordinates": [ [ -87.99138, 47.64402 ], [ -88.72866667, 48.1225 ] ] } },
  { "type": "Feature", "properties": { "dec_id": "149951", "mission_id": 8, "tag_sn": 1513, "mission_end": "2015-09-15 06:00:00", "Platform_ID_No": 149951, "first_posrep": "2015-09-15 09:38:28", "Loc_quality": "B", "Latitude": 48.16748, "Longitude": -88.50129, "pop_Geom": null, "species": "LT", "sex": "F", "maturity": "Y", "lipid": 66.1, "length_mm": 859.0, "weight_g": 7135.0, "release_date": "2015-06-04 00:00:00", "release_group": "1", "release_Geom": null, "distance_traveled_km": 12.81051962130044, "mission_duration_days": 103.0, "report_delay_days": 0.1517129628919065 }, "geometry": { "type": "LineString", "coordinates": [ [ -88.50129, 48.16748 ], [ -88.66516667, 48.13216667 ] ] } },
  { "type": "Feature", "properties": { "dec_id": "149952", "mission_id": 8, "tag_sn": 1517, "mission_end": "2015-09-15 06:00:00", "Platform_ID_No": 149952, "first_posrep": "2015-09-15 07:54:35", "Loc_quality": "A", "Latitude": 48.57167, "Longitude": -86.94024, "pop_Geom": null, "species": "FT", "sex": "F", "maturity": "S", "lipid": 73.0, "length_mm": 840.0, "weight_g": 8400.0, "release_date": "2015-06-03 00:00:00", "release_group": "2", "release_Geom": null, "distance_traveled_km": 141.06021972256866, "mission_duration_days": 104.0, "report_delay_days": 0.079571759328246117 }, "geometry": { "type": "LineString", "coordinates": [ [ -86.94024, 48.57167 ], [ -88.71483333, 48.11366667 ] ] } },
  { "type": "Feature", "properties": { "dec_id": "150142", "mission_id": 8, "tag_sn": 1535, "mission_end": "2015-09-13 06:00:00", "Platform_ID_No": 150142, "first_posrep": "2015-09-13 23:44:13", "Loc_quality": "B", "Latitude": 48.20208, "Longitude": -88.31773, "pop_Geom": null, "species": "LT", "sex": "M", "maturity": null, "lipid": 30.4, "length_mm": 736.0, "weight_g": 3750.0, "release_date": "2015-06-02 00:00:00", "release_group": "1", "release_Geom": null, "distance_traveled_km": 7.7740141212142673, "mission_duration_days": 103.0, "report_delay_days": 0.73903935169801116 }, "geometry": { "type": "LineString", "coordinates": [ [ -88.31773, 48.20208 ], [ -88.419, 48.18466667 ] ] } },
  { "type": "Feature", "properties": { "dec_id": "150143", "mission_id": 8, "tag_sn": 1538, "mission_end": "2015-09-14 06:00:00", "Platform_ID_No": 150143, "first_posrep": "2015-09-14 15:31:03", "Loc_quality": "1", "Latitude": 47.70133, "Longitude": -88.1391, "pop_Geom": null, "species": "FT", "sex": "M", "maturity": "S", "lipid": 76.1, "length_mm": 838.0, "weight_g": 8490.0, "release_date": "2015-06-03 00:00:00", "release_group": "1", "release_Geom": null, "distance_traveled_km": 64.305733940703107, "mission_duration_days": 103.0, "report_delay_days": 0.39656249992549419 }, "geometry": { "type": "LineString", "coordinates": [ [ -88.1391, 47.70133 ], [ -88.72866667, 48.1225 ] ] } },
  { "type": "Feature", "properties": { "dec_id": "150144", "mission_id": 8, "tag_sn": 1551, "mission_end": "2015-09-14 06:00:00", "Platform_ID_No": 150144, "first_posrep": "2015-09-14 14:16:41", "Loc_quality": "B", "Latitude": 48.20972, "Longitude": -88.42862, "pop_Geom": null, "species": "LT", "sex": "?", "maturity": null, "lipid": 31.1, "length_mm": 775.0, "weight_g": 4430.0, "release_date": "2015-06-02 00:00:00", "release_group": "1", "release_Geom": null, "distance_traveled_km": 2.8761154020734843, "mission_duration_days": 104.0, "report_delay_days": 0.34491898166015744 }, "geometry": { "type": "LineString", "coordinates": [ [ -88.42862, 48.20972 ], [ -88.419, 48.18466667 ] ] } },
  { "type": "Feature", "properties": { "dec_id": "150145", "mission_id": 8, "tag_sn": 1564, "mission_end": "2015-09-13 06:00:00", "Platform_ID_No": 150145, "first_posrep": "2015-09-13 23:32:57", "Loc_quality": "B", "Latitude": 48.21575, "Longitude": -88.29915, "pop_Geom": null, "species": "RF", "sex": "M", "maturity": "Y", "lipid": 26.3, "length_mm": 718.0, "weight_g": 4090.0, "release_date": "2015-06-04 00:00:00", "release_group": "1", "release_Geom": null, "distance_traveled_km": 28.764942099932501, "mission_duration_days": 101.0, "report_delay_days": 0.73121527768671513 }, "geometry": { "type": "LineString", "coordinates": [ [ -88.29915, 48.21575 ], [ -88.66516667, 48.13216667 ] ] } }
]
};


var first_message = {
"type": "FeatureCollection",
"crs": { "type": "name", "properties": { "name": "first_message" } },
"features": [
  { "type": "Feature", "properties": { "dec_id": "139260", "mission_id": 8, "tag_sn": 895, "mission_end": "2015-09-15 06:00:00", "Platform_ID_No": 139260, "first_posrep": "2015-09-15 07:55:11", "Loc_quality": "B", "Latitude": 48.18396, "Longitude": -88.67762, "species": "FT", "sex": "F", "maturity": "S", "lipid": 73.3, "length_mm": 883.0, "weight_g": 9655.0, "release_date": "2015-06-03 00:00:00", "release_group": "2", "release_Geom": null, "linestring_Geom": null, "distance_traveled_km": 8.292150913435858, "mission_duration_days": 104.0, "report_delay_days": 0.079988426063209772 }, "geometry": { "type": "Point", "coordinates": [ -88.67762, 48.18396 ] } },
  { "type": "Feature", "properties": { "dec_id": "139263", "mission_id": 8, "tag_sn": 970, "mission_end": "2015-09-13 06:00:00", "Platform_ID_No": 139263, "first_posrep": "2015-09-13 14:36:28", "Loc_quality": "B", "Latitude": 48.01486, "Longitude": -89.06286, "species": "FT", "sex": "M", "maturity": "S", "lipid": 74.2, "length_mm": 844.0, "weight_g": 10235.0, "release_date": "2015-06-03 00:00:00", "release_group": "1", "release_Geom": null, "linestring_Geom": null, "distance_traveled_km": 27.632676870953333, "mission_duration_days": 102.0, "report_delay_days": 0.3586574075743556 }, "geometry": { "type": "Point", "coordinates": [ -89.06286, 48.01486 ] } },
  { "type": "Feature", "properties": { "dec_id": "139265", "mission_id": 8, "tag_sn": 983, "mission_end": "2015-09-14 06:00:00", "Platform_ID_No": 139265, "first_posrep": "2015-09-14 09:48:44", "Loc_quality": "A", "Latitude": 48.15568, "Longitude": -89.09548, "species": "FT", "sex": "M", "maturity": "S", "lipid": 76.1, "length_mm": 907.0, "weight_g": 9200.0, "release_date": "2015-06-03 00:00:00", "release_group": "1", "release_Geom": null, "linestring_Geom": null, "distance_traveled_km": 27.548054704798606, "mission_duration_days": 103.0, "report_delay_days": 0.1588425925001502 }, "geometry": { "type": "Point", "coordinates": [ -89.09548, 48.15568 ] } },
  { "type": "Feature", "properties": { "dec_id": "139266", "mission_id": 8, "tag_sn": 992, "mission_end": "2015-09-15 06:00:00", "Platform_ID_No": 139266, "first_posrep": "2015-09-15 07:56:59", "Loc_quality": "B", "Latitude": 48.03995, "Longitude": -89.24352, "species": "FT", "sex": "F", "maturity": "S", "lipid": 77.7, "length_mm": 888.0, "weight_g": 12690.0, "release_date": "2015-06-03 00:00:00", "release_group": "2", "release_Geom": null, "linestring_Geom": null, "distance_traveled_km": 40.238430869102864, "mission_duration_days": 104.0, "report_delay_days": 0.081238425802439451 }, "geometry": { "type": "Point", "coordinates": [ -89.24352, 48.03995 ] } },
  { "type": "Feature", "properties": { "dec_id": "139267", "mission_id": 8, "tag_sn": 993, "mission_end": "2015-09-15 06:00:00", "Platform_ID_No": 139267, "first_posrep": "2015-09-15 09:37:54", "Loc_quality": "B", "Latitude": 48.1695, "Longitude": -88.53531, "species": "LT", "sex": "M", "maturity": "Y", "lipid": 24.6, "length_mm": 718.0, "weight_g": 2320.0, "release_date": "2015-06-04 00:00:00", "release_group": "1", "release_Geom": null, "linestring_Geom": null, "distance_traveled_km": 10.516318055164305, "mission_duration_days": 103.0, "report_delay_days": 0.1513194446451962 }, "geometry": { "type": "Point", "coordinates": [ -88.53531, 48.1695 ] } },
  { "type": "Feature", "properties": { "dec_id": "149934", "mission_id": 8, "tag_sn": 996, "mission_end": "2015-09-15 06:00:00", "Platform_ID_No": 149934, "first_posrep": "2015-09-15 11:13:53", "Loc_quality": "B", "Latitude": 48.15886, "Longitude": -89.04456, "species": "FT", "sex": "M", "maturity": "S", "lipid": 72.8, "length_mm": 904.0, "weight_g": 10610.0, "release_date": "2015-06-03 00:00:00", "release_group": "1", "release_Geom": null, "linestring_Geom": null, "distance_traveled_km": 23.854578824154817, "mission_duration_days": 104.0, "report_delay_days": 0.21797453705221415 }, "geometry": { "type": "Point", "coordinates": [ -89.04456, 48.15886 ] } },
  { "type": "Feature", "properties": { "dec_id": "139274", "mission_id": 8, "tag_sn": 1013, "mission_end": "2015-09-14 06:00:00", "Platform_ID_No": 139274, "first_posrep": "2015-09-14 09:46:12", "Loc_quality": "A", "Latitude": 47.79996, "Longitude": -89.15436, "species": "LT", "sex": "M", "maturity": "Y", "lipid": 19.8, "length_mm": 749.0, "weight_g": 3530.0, "release_date": "2015-06-05 00:00:00", "release_group": "1", "release_Geom": null, "linestring_Geom": null, "distance_traveled_km": 69.693222371420887, "mission_duration_days": 101.0, "report_delay_days": 0.15708333346992731 }, "geometry": { "type": "Point", "coordinates": [ -89.15436, 47.79996 ] } },
  { "type": "Feature", "properties": { "dec_id": "149935", "mission_id": 8, "tag_sn": 1028, "mission_end": "2015-09-13 06:00:00", "Platform_ID_No": 149935, "first_posrep": "2015-09-13 19:49:16", "Loc_quality": "2", "Latitude": 48.19108, "Longitude": -88.3705, "species": "RF", "sex": "F", "maturity": "Y", "lipid": 27.6, "length_mm": 755.0, "weight_g": 4155.0, "release_date": "2015-06-02 00:00:00", "release_group": "1", "release_Geom": null, "linestring_Geom": null, "distance_traveled_km": 3.676003391468611, "mission_duration_days": 103.0, "report_delay_days": 0.57587962970137596 }, "geometry": { "type": "Point", "coordinates": [ -88.3705, 48.19108 ] } },
  { "type": "Feature", "properties": { "dec_id": "149937", "mission_id": 8, "tag_sn": 1072, "mission_end": "2015-09-13 06:00:00", "Platform_ID_No": 149937, "first_posrep": "2015-09-13 09:46:50", "Loc_quality": "B", "Latitude": 48.17917, "Longitude": -88.52109, "species": "LT", "sex": "M", "maturity": null, "lipid": 25.2, "length_mm": 914.0, "weight_g": 6750.0, "release_date": "2015-06-02 00:00:00", "release_group": "1", "release_Geom": null, "linestring_Geom": null, "distance_traveled_km": 7.6162425260506037, "mission_duration_days": 103.0, "report_delay_days": 0.15752314822748303 }, "geometry": { "type": "Point", "coordinates": [ -88.52109, 48.17917 ] } },
  { "type": "Feature", "properties": { "dec_id": "149939", "mission_id": 8, "tag_sn": 1082, "mission_end": "2015-09-13 06:00:00", "Platform_ID_No": 149939, "first_posrep": "2015-09-13 11:18:14", "Loc_quality": "B", "Latitude": 48.19805, "Longitude": -88.38013, "species": "LT", "sex": "F", "maturity": "Y", "lipid": 57.3, "length_mm": 910.0, "weight_g": 7770.0, "release_date": "2015-06-05 00:00:00", "release_group": "1", "release_Geom": null, "linestring_Geom": null, "distance_traveled_km": 3.1596546742925469, "mission_duration_days": 100.0, "report_delay_days": 0.22099537029862404 }, "geometry": { "type": "Point", "coordinates": [ -88.38013, 48.19805 ] } },
  { "type": "Feature", "properties": { "dec_id": "149940", "mission_id": 8, "tag_sn": 1097, "mission_end": "2015-09-14 06:00:00", "Platform_ID_No": 149940, "first_posrep": "2016-06-19 19:00:55", "Loc_quality": "B", "Latitude": 48.1785, "Longitude": -88.76092, "species": "LT", "sex": "M", "maturity": null, "lipid": 46.1, "length_mm": 769.0, "weight_g": 4495.0, "release_date": "2015-06-03 00:00:00", "release_group": "1", "release_Geom": null, "linestring_Geom": null, "distance_traveled_km": 6.6732948800617793, "mission_duration_days": 382.0, "report_delay_days": 279.54230324085802 }, "geometry": { "type": "Point", "coordinates": [ -88.76092, 48.1785 ] } },
  { "type": "Feature", "properties": { "dec_id": "149941", "mission_id": 8, "tag_sn": 1109, "mission_end": "2015-09-14 06:00:00", "Platform_ID_No": 149941, "first_posrep": "2015-09-14 09:46:21", "Loc_quality": "A", "Latitude": 48.11736, "Longitude": -88.50121, "species": "LT", "sex": "M", "maturity": null, "lipid": 38.3, "length_mm": 814.0, "weight_g": 4855.0, "release_date": "2015-06-02 00:00:00", "release_group": "1", "release_Geom": null, "linestring_Geom": null, "distance_traveled_km": 9.665864673450324, "mission_duration_days": 104.0, "report_delay_days": 0.1571875000372529 }, "geometry": { "type": "Point", "coordinates": [ -88.50121, 48.11736 ] } },
  { "type": "Feature", "properties": { "dec_id": "150146", "mission_id": 8, "tag_sn": 1113, "mission_end": "2015-09-14 06:00:00", "Platform_ID_No": 150146, "first_posrep": "2015-09-14 19:34:15", "Loc_quality": "0", "Latitude": 48.19757, "Longitude": -88.40424, "species": "RF", "sex": "F", "maturity": "Y", "lipid": 32.0, "length_mm": 850.0, "weight_g": 5820.0, "release_date": "2015-06-02 00:00:00", "release_group": "1", "release_Geom": null, "linestring_Geom": null, "distance_traveled_km": 1.8063366732446797, "mission_duration_days": 104.0, "report_delay_days": 0.5654513887129724 }, "geometry": { "type": "Point", "coordinates": [ -88.40424, 48.19757 ] } },
  { "type": "Feature", "properties": { "dec_id": "149942", "mission_id": 8, "tag_sn": 1424, "mission_end": "2015-09-14 06:00:00", "Platform_ID_No": 149942, "first_posrep": "2015-09-14 15:31:43", "Loc_quality": "3", "Latitude": 48.13993, "Longitude": -88.67469, "species": "RF", "sex": "F", "maturity": "Y", "lipid": 17.2, "length_mm": 864.0, "weight_g": 5335.0, "release_date": "2015-06-04 00:00:00", "release_group": "1", "release_Geom": null, "linestring_Geom": null, "distance_traveled_km": 1.1169492183813747, "mission_duration_days": 102.0, "report_delay_days": 0.39702546317130327 }, "geometry": { "type": "Point", "coordinates": [ -88.67469, 48.13993 ] } },
  { "type": "Feature", "properties": { "dec_id": "149944", "mission_id": 8, "tag_sn": 1441, "mission_end": "2015-09-15 06:00:00", "Platform_ID_No": 149944, "first_posrep": "2015-09-15 07:52:49", "Loc_quality": "B", "Latitude": 47.97099, "Longitude": -88.75989, "species": "LT", "sex": "M", "maturity": "Y", "lipid": 55.0, "length_mm": 738.0, "weight_g": 4345.0, "release_date": "2015-06-04 00:00:00", "release_group": "1", "release_Geom": null, "linestring_Geom": null, "distance_traveled_km": 19.262552147594494, "mission_duration_days": 103.0, "report_delay_days": 0.078344907611608505 }, "geometry": { "type": "Point", "coordinates": [ -88.75989, 47.97099 ] } },
  { "type": "Feature", "properties": { "dec_id": "150148", "mission_id": 8, "tag_sn": 1443, "mission_end": "2015-09-13 06:00:00", "Platform_ID_No": 150148, "first_posrep": "2015-09-14 01:39:09", "Loc_quality": "B", "Latitude": 48.16363, "Longitude": -88.432, "species": "LT", "sex": "F", "maturity": null, "lipid": 47.1, "length_mm": 754.0, "weight_g": 4255.0, "release_date": "2015-06-02 00:00:00", "release_group": "1", "release_Geom": null, "linestring_Geom": null, "distance_traveled_km": 2.5310905639658094, "mission_duration_days": 104.0, "report_delay_days": 0.81885416666045785 }, "geometry": { "type": "Point", "coordinates": [ -88.432, 48.16363 ] } },
  { "type": "Feature", "properties": { "dec_id": "149946", "mission_id": 8, "tag_sn": 1455, "mission_end": "2015-09-14 06:00:00", "Platform_ID_No": 149946, "first_posrep": "2015-09-14 17:53:28", "Loc_quality": "B", "Latitude": 47.65524, "Longitude": -88.23599, "species": "FT", "sex": "M", "maturity": "S", "lipid": 78.4, "length_mm": 817.0, "weight_g": 8390.0, "release_date": "2015-06-03 00:00:00", "release_group": "2", "release_Geom": null, "linestring_Geom": null, "distance_traveled_km": 62.295085843622985, "mission_duration_days": 103.0, "report_delay_days": 0.4954629628919065 }, "geometry": { "type": "Point", "coordinates": [ -88.23599, 47.65524 ] } },
  { "type": "Feature", "properties": { "dec_id": "149947", "mission_id": 8, "tag_sn": 1461, "mission_end": "2015-09-15 06:00:00", "Platform_ID_No": 149947, "first_posrep": "2015-09-15 09:36:16", "Loc_quality": "B", "Latitude": 48.05474, "Longitude": -86.55825, "species": "FT", "sex": "M", "maturity": "S", "lipid": 76.7, "length_mm": 884.0, "weight_g": 12175.0, "release_date": "2015-06-03 00:00:00", "release_group": "2", "release_Geom": null, "linestring_Geom": null, "distance_traveled_km": 160.80199165137688, "mission_duration_days": 104.0, "report_delay_days": 0.15018518501892686 }, "geometry": { "type": "Point", "coordinates": [ -86.55825, 48.05474 ] } },
  { "type": "Feature", "properties": { "dec_id": "149949", "mission_id": 8, "tag_sn": 1502, "mission_end": "2015-09-15 06:00:00", "Platform_ID_No": 149949, "first_posrep": "2015-09-15 09:35:42", "Loc_quality": "A", "Latitude": 47.64402, "Longitude": -87.99138, "species": "FT", "sex": "M", "maturity": "S", "lipid": 75.7, "length_mm": 918.0, "weight_g": 11710.0, "release_date": "2015-06-03 00:00:00", "release_group": "1", "release_Geom": null, "linestring_Geom": null, "distance_traveled_km": 76.62350242899484, "mission_duration_days": 104.0, "report_delay_days": 0.14979166677221656 }, "geometry": { "type": "Point", "coordinates": [ -87.99138, 47.64402 ] } },
  { "type": "Feature", "properties": { "dec_id": "149951", "mission_id": 8, "tag_sn": 1513, "mission_end": "2015-09-15 06:00:00", "Platform_ID_No": 149951, "first_posrep": "2015-09-15 09:38:28", "Loc_quality": "B", "Latitude": 48.16748, "Longitude": -88.50129, "species": "LT", "sex": "F", "maturity": "Y", "lipid": 66.1, "length_mm": 859.0, "weight_g": 7135.0, "release_date": "2015-06-04 00:00:00", "release_group": "1", "release_Geom": null, "linestring_Geom": null, "distance_traveled_km": 12.81051962130044, "mission_duration_days": 103.0, "report_delay_days": 0.1517129628919065 }, "geometry": { "type": "Point", "coordinates": [ -88.50129, 48.16748 ] } },
  { "type": "Feature", "properties": { "dec_id": "149952", "mission_id": 8, "tag_sn": 1517, "mission_end": "2015-09-15 06:00:00", "Platform_ID_No": 149952, "first_posrep": "2015-09-15 07:54:35", "Loc_quality": "A", "Latitude": 48.57167, "Longitude": -86.94024, "species": "FT", "sex": "F", "maturity": "S", "lipid": 73.0, "length_mm": 840.0, "weight_g": 8400.0, "release_date": "2015-06-03 00:00:00", "release_group": "2", "release_Geom": null, "linestring_Geom": null, "distance_traveled_km": 141.06021972256866, "mission_duration_days": 104.0, "report_delay_days": 0.079571759328246117 }, "geometry": { "type": "Point", "coordinates": [ -86.94024, 48.57167 ] } },
  { "type": "Feature", "properties": { "dec_id": "150142", "mission_id": 8, "tag_sn": 1535, "mission_end": "2015-09-13 06:00:00", "Platform_ID_No": 150142, "first_posrep": "2015-09-13 23:44:13", "Loc_quality": "B", "Latitude": 48.20208, "Longitude": -88.31773, "species": "LT", "sex": "M", "maturity": null, "lipid": 30.4, "length_mm": 736.0, "weight_g": 3750.0, "release_date": "2015-06-02 00:00:00", "release_group": "1", "release_Geom": null, "linestring_Geom": null, "distance_traveled_km": 7.7740141212142673, "mission_duration_days": 103.0, "report_delay_days": 0.73903935169801116 }, "geometry": { "type": "Point", "coordinates": [ -88.31773, 48.20208 ] } },
  { "type": "Feature", "properties": { "dec_id": "150143", "mission_id": 8, "tag_sn": 1538, "mission_end": "2015-09-14 06:00:00", "Platform_ID_No": 150143, "first_posrep": "2015-09-14 15:31:03", "Loc_quality": "1", "Latitude": 47.70133, "Longitude": -88.1391, "species": "FT", "sex": "M", "maturity": "S", "lipid": 76.1, "length_mm": 838.0, "weight_g": 8490.0, "release_date": "2015-06-03 00:00:00", "release_group": "1", "release_Geom": null, "linestring_Geom": null, "distance_traveled_km": 64.305733940703107, "mission_duration_days": 103.0, "report_delay_days": 0.39656249992549419 }, "geometry": { "type": "Point", "coordinates": [ -88.1391, 47.70133 ] } },
  { "type": "Feature", "properties": { "dec_id": "150144", "mission_id": 8, "tag_sn": 1551, "mission_end": "2015-09-14 06:00:00", "Platform_ID_No": 150144, "first_posrep": "2015-09-14 14:16:41", "Loc_quality": "B", "Latitude": 48.20972, "Longitude": -88.42862, "species": "LT", "sex": "?", "maturity": null, "lipid": 31.1, "length_mm": 775.0, "weight_g": 4430.0, "release_date": "2015-06-02 00:00:00", "release_group": "1", "release_Geom": null, "linestring_Geom": null, "distance_traveled_km": 2.8761154020734843, "mission_duration_days": 104.0, "report_delay_days": 0.34491898166015744 }, "geometry": { "type": "Point", "coordinates": [ -88.42862, 48.20972 ] } },
  { "type": "Feature", "properties": { "dec_id": "150145", "mission_id": 8, "tag_sn": 1564, "mission_end": "2015-09-13 06:00:00", "Platform_ID_No": 150145, "first_posrep": "2015-09-13 23:32:57", "Loc_quality": "B", "Latitude": 48.21575, "Longitude": -88.29915, "species": "RF", "sex": "M", "maturity": "Y", "lipid": 26.3, "length_mm": 718.0, "weight_g": 4090.0, "release_date": "2015-06-04 00:00:00", "release_group": "1", "release_Geom": null, "linestring_Geom": null, "distance_traveled_km": 28.764942099932501, "mission_duration_days": 101.0, "report_delay_days": 0.73121527768671513 }, "geometry": { "type": "Point", "coordinates": [ -88.29915, 48.21575 ] } }
]
};


var release_sites = {
"type": "FeatureCollection",
"crs": { "type": "name", "properties": { "name": "release_sites" } },
"features": [
{ "type": "Feature", "properties": { "id": 3, "site_id": "8789", "release_group": 1, "release_date": "2015-06-02", "release_time": "12:45", "lat_dd_mmm": "48 11.08", "lon_dd_mmm": "88 25.14", "lat_DD": 48.18466667, "lon_DD": -88.419, "notes": null }, "geometry": { "type": "Point", "coordinates": [ -88.419, 48.18466667 ] } },
{ "type": "Feature", "properties": { "id": 4, "site_id": "8790", "release_group": 1, "release_date": "2015-06-03", "release_time": "14:42", "lat_dd_mmm": "48 07.35", "lon_dd_mmm": "88 43.72", "lat_DD": 48.1225, "lon_DD": -88.72866667, "notes": null }, "geometry": { "type": "Point", "coordinates": [ -88.72866667, 48.1225 ] } },
{ "type": "Feature", "properties": { "id": 5, "site_id": "8791", "release_group": 2, "release_date": "2015-06-03", "release_time": "14:55", "lat_dd_mmm": "48 06.82", "lon_dd_mmm": "88 42.89", "lat_DD": 48.11366667, "lon_DD": -88.71483333, "notes": null }, "geometry": { "type": "Point", "coordinates": [ -88.71483333, 48.11366667 ] } },
{ "type": "Feature", "properties": { "id": 6, "site_id": "8792", "release_group": 1, "release_date": "2015-06-04", "release_time": "13:37", "lat_dd_mmm": "48 07.93", "lon_dd_mmm": "88 39.91", "lat_DD": 48.13216667, "lon_DD": -88.66516667, "notes": null }, "geometry": { "type": "Point", "coordinates": [ -88.66516667, 48.13216667 ] } },
{ "type": "Feature", "properties": { "id": 7, "site_id": "8793", "release_group": 1, "release_date": "2015-06-05", "release_time": "9:21", "lat_dd_mmm": "48 11.15", "lon_dd_mmm": "88 25.11", "lat_DD": 48.18583333, "lon_DD": -88.4185, "notes": null }, "geometry": { "type": "Point", "coordinates": [ -88.4185, 48.18583333 ] } }
]
};


// Map tile layers
var osm = L.tileLayer( 'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',
})

var Esri_OceanBasemap = L.tileLayer('http://server.arcgisonline.com/ArcGIS/rest/services/Ocean_Basemap/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Sources: GEBCO, NOAA, CHS, OSU, UNH, CSUMB, National Geographic, DeLorme, NAVTEQ, and Esri',
	maxZoom: 14
})


// Create map varable
var mymap = L.map('mapid', {
  center: [47.75, -88],
  zoom: 7,
  layers: [Esri_OceanBasemap] //, osm, Thunderforest_SpinalMap],
});

var measureControl = L.control.measure({
   primaryLengthUnit: 'miles', secondaryLengthUnit: 'kilometers',
   primaryAreaUnit: 'acres', secondaryAreaUnit: undefined,
   activeColor: '#FF6B6B',
   completedColor: '#0B486B',
   position: 'topleft'
 });
measureControl.addTo(mymap);

var distanceStyle = {
    "color": "#424242",
    "weight": 1.5,
    "opacity": 0.85
};

var releaseStyle = {
    radius: 5,
    fillColor: "#3299BB",
    color: "#424242",
    weight: 1,
    opacity: 1,
    fillOpacity: 0.9
};


function getPopupColor(d) {
    return d == 'LT'   ? '#33a02c' :
           d == 'FT' ? '#edc951' :
           d == 'RF' ? '#cc333f' :
                        '#FFFFFF';
}

function popupStyle(feature) {
  return {
      radius: 4,
      fillColor: getPopupColor(feature.properties.species),
      color: "#424242",
      weight: 1,
      opacity: 1,
      fillOpacity: 0.9
  };
}

// specify popup options
var customOptions =
    {
    'className' : 'custom'
    }



var lines = L.geoJson(distance, {
    style: distanceStyle
})
lines.addTo(mymap);

var relases = L.geoJson(release_sites, {
  pointToLayer: function (feature, latlng) {
      return L.circleMarker(latlng, releaseStyle);
  },
  onEachFeature: function (feature, layer) {
    layer.bindPopup("<h3>Release Site<br></h3>" +
                    "<hr>" +
                    "<b>Release Date: </b>" + feature.properties.release_date);
  }
})
relases.addTo(mymap);



var popups = L.geoJson(first_message, {
    pointToLayer: function (feature, latlng) {
        return L.circleMarker(latlng, null);
    },
    onEachFeature: function (feature, layer) {
      layer.bindPopup("<h3>Popup Site - Tag # " + feature.properties.tag_sn + "<br></h3>" +
                      "<hr>" +
                      "<b>Sex: </b>" + feature.properties.sex + "<br>" +
                      "<b>Lipid: </b>" + feature.properties.lipid + "%<br>" +
                      "<b>First Message: </b>" + feature.properties.first_posrep + " (" +feature.properties.Loc_quality +  ")" + "<br>" +
                      "<b>Coordinates: </b>" + feature.properties.Latitude + ", "+ feature.properties.Longitude + "<br>" +
                      "<b>Distance Traveled : </b>" + Math.round((feature.properties.distance_traveled_km * 0.539957) * 100) / 100 + " N mi", customOptions);
    },
    style: popupStyle,
})

popups.addTo(mymap);



var baseMaps = {
    "ESRI OceanBasemap": Esri_OceanBasemap,
    "Open Steet Maps": osm,
};


var layer_control = L.control.layers(baseMaps, null, {position:'topleft'})
layer_control.addTo(mymap);

var legend = L.control({position: 'bottomleft'});

legend.onAdd = function (mymap) {

    var div = L.DomUtil.create('div', 'info legend'),
        grades = ['LT', 'FT', 'RF'],
        labels = [];

    div.innerHTML = '<h3 style="text-align:center;">Legend</h3><hr>'
    div.innerHTML += '<i style="background:#3299BB"></i>&nbsp release site'
    // loop through our density intervals and generate a label with a colored square for each interval
    div.innerHTML += '<h4 style="text-align:center;">Pop Up Locations</h4><hr>'
    for (var i = 0; i < grades.length; i++) {

        div.innerHTML +=
            '<i class="circle" style="background:' + getPopupColor(grades[i]) + '"></i> ' +
            (grades[i] ? '&nbsp; ' + grades[i] + '<br>' : '+');
    }

    return div;
};

legend.addTo(mymap);
